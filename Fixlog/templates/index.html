<!-- templates/index.html -->
{% extends "_layout.html" %}

{% block title %}ç•°å¸¸ç¶­ä¿®ç´€éŒ„{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <h1 class="display-5 fw-bold mb-0">ç•°å¸¸ç¶­ä¿®ç´€éŒ„ç¸½è¦½</h1>
  <div>
    <a href="?sort=default" class="btn btn-outline-secondary btn-sm {% if sort == 'default' %}active{% endif %}">é è¨­</a>
    <a href="?sort=alpha" class="btn btn-outline-secondary btn-sm {% if sort == 'alpha' %}active{% endif %}">ç­†ç•«</a>

    <a href="?sort=date&order={{ 'asc' if order == 'desc' else 'desc' }}" class="btn btn-outline-primary btn-sm {% if sort == 'date' %}active{% endif %}">
      æ™‚é–“
      {% if sort == 'date' %}
        {% if order == 'asc' %}
          â–²
        {% else %}
          â–¼
        {% endif %}
      {% endif %}
    </a>

    <a href="?sort=views&order={{ 'asc' if order == 'desc' else 'desc' }}" class="btn btn-outline-primary btn-sm {% if sort == 'views' %}active{% endif %}">
      ç€è¦½
      {% if sort == 'views' %}
        {% if order == 'asc' %}
          â–²
        {% else %}
          â–¼
        {% endif %}
      {% endif %}
    </a>
  </div>
</div>

{% if repairs %}
  {% for r in repairs %}
    <div class="card mb-3 shadow-sm position-relative">
      {% if hot_ids and r.id in hot_ids %}
        <div style="position: absolute; top: 10px; right: 10px; display: flex; align-items: center; background-color: rgba(255, 240, 200, 0.9); border-radius: 6px; padding: 4px 8px; z-index: 10;">
          <span style="color: #e55300; font-weight: bold; margin-right: 6px;">ç†±é–€</span>
          <img src="{{ url_for('static', filename='img/hot.png') }}" alt="ç†±é–€æ–‡ç« " title="ç†±é–€æ–‡ç« " style="width: 32px; height: auto;">
        </div>
      {% endif %}
      <div class="card-body">
        <h3 class="card-title">
          <a href="{{ url_for('repair_detail', repair_id=r.id) }}" class="text-decoration-none">{{ r.title }}</a>
        </h3>
        <p class="text-muted mb-1">ğŸ“… {{ r.date }} | ğŸ‘¤ {{ r.author }} | ğŸ·ï¸ {{ r.status }}</p>
        <p class="text-muted mb-1">ğŸ› ï¸ {{ r.category }} | ğŸ‘ï¸ {{ r.views }} æ¬¡ç€è¦½</p>
        <a href="{{ url_for('repair_detail', repair_id=r.id) }}" class="btn btn-sm btn-outline-primary">é–±è®€æ›´å¤š</a>
        {% if session.get('username') == 'admin' %}
          <form method="POST" action="{{ url_for('delete_repair', repair_id=r.id) }}" class="d-inline" onsubmit="return confirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿ');">
            <button type="submit" class="btn btn-sm btn-outline-danger">åˆªé™¤</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-info text-center">
    ğŸš« ç›®å‰å°šç„¡ç•°å¸¸ç¶­ä¿®ç´€éŒ„ã€‚
  </div>
{% endif %}
{% endblock %}